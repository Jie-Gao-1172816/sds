{% extends "base.html" %}
{% block content %}

<h2>{% if edit %}Edit Student{% else %}Add Student{% endif %}</h2>

{% if edit %}
<form action="/student/edit" method="post">
{% else %}
<form action="/student/add" method="post">
{% endif %}

  <!-- EDIT: 不允许改 student_id / enrollment_date，所以用 hidden 保留 -->
  {% if edit %}
    <input type="hidden" name="student_id" value="{{ student.student_id }}">
    <input type="hidden" name="enrollment_date" value="{{ student.enrollment_date }}">
  {% endif %}

  <div class="mb-3">
    <label class="form-label">Student ID</label>
    {% if edit %}
      <div class="form-control-plaintext">{{ student.student_id }}</div>
    {% else %}
      <div class="form-control-plaintext text-muted">Auto-generated by the database</div>
    {% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label">Enrollment Date</label>
    {% if edit %}
      <div class="form-control-plaintext">{{ student.enrollment_date }}</div>
    {% else %}
      <input type="date"
             class="form-control"
             name="enrollment_date"
             max="{{ today }}"
             value="{{ student.enrollment_date or today }}">
      <div class="form-text">Must be today or earlier.</div>
    {% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label">First Name *</label>
    <input type="text" class="form-control" name="first_name"
           value="{{ student.first_name or '' }}" required>
  </div>

  <div class="mb-3">
    <label class="form-label">Last Name *</label>
    <input type="text" class="form-control" name="last_name"
           value="{{ student.last_name or '' }}" required>
  </div>

  <div class="mb-3">
    <label class="form-label">Email (optional)</label>
    <input type="email" class="form-control" name="email"
           value="{{ student.email or '' }}">
  </div>

  <div class="mb-3">
    <label class="form-label">Phone (optional)</label>
    <input type="text" class="form-control" name="phone"
           value="{{ student.phone or '' }}">
  </div>

  <div class="mb-3">
    <label class="form-label">Date of Birth *</label>
    <input type="date" class="form-control" name="date_of_birth"
           value="{{ student.date_of_birth or '' }}" required>
  </div>

  <button type="submit" class="btn btn-dark">
    {% if edit %}Update{% else %}Add{% endif %}
  </button>

  <a href="{{ url_for('student_list') }}" class="btn btn-outline-secondary ms-2">
    Cancel
  </a>

</form>

{% endblock %}
